# 移除闪卡功能操作清单

## ✅ 可以安全删除闪卡功能！

闪卡功能模块化程度很高，可以安全移除。

---

## 📋 操作步骤

### 1️⃣ 删除闪卡模块目录
```bash
# 删除整个 flashcard 目录
rm -rf src/flashcard/
```

### 2️⃣ 修改 src/utils/toolbarHijacker.ts

需要删除/注释以下内容：

**删除导入语句**（第 19 行）：
```typescript
import { FlashcardQuickSwitchManager } from '../flashcard';
```

**删除属性声明**（第 31 行）：
```typescript
private flashcardQuickSwitchManager: FlashcardQuickSwitchManager;
```

**删除创建和初始化代码**（第 60-83 行）：
```typescript
// 初始化闪卡快切管理器
this.flashcardQuickSwitchManager = new FlashcardQuickSwitchManager({
    enabled: true,
    maxHistory: 10,
    ballPosition: { x: 20, y: 100 },
    enablePinning: true,
    showUsageCount: true,
    enableDrag: true
});
Logger.log('✅ FlashcardQuickSwitchManager 已创建');

// ...

// 初始化闪卡快切管理器（异步）
this.flashcardQuickSwitchManager.initialize().then(() => {
    Logger.log('✅ FlashcardQuickSwitchManager 初始化完成');
}).catch((error) => {
    Logger.error('❌ FlashcardQuickSwitchManager 初始化失败:', error);
});
```

**删除销毁代码**（第 1491-1495 行）：
```typescript
// 销毁闪卡快切管理器
if (this.flashcardQuickSwitchManager) {
    this.flashcardQuickSwitchManager.destroy().catch((error) => {
        Logger.error('销毁FlashcardQuickSwitchManager失败:', error);
    });
}
```

**删除访问接口**（第 2600-2602 行）：
```typescript
/**
 * 获取闪卡快切管理器（用于调试）
 */
public getFlashcardQuickSwitchManager(): FlashcardQuickSwitchManager {
    return this.flashcardQuickSwitchManager;
}
```

### 3️⃣ （可选）修改 src/utils/logger.ts

删除第 130 行的闪卡图标定义：
```typescript
'flashcard': '🃏',  // 可以删除这行
```

### 4️⃣ 更新文档

需要删除以下文件中的闪卡功能描述：

**README 文件：**
- README.md - 删除 "### ⚡ Flashcard Quick Switch" 章节
- README_zh_CN.md - 删除 "### ⚡ 闪卡快速切换" 章节
- dev/README.md - 同上
- dev/README_zh_CN.md - 同上
- dist/README.md - 同上
- dist/README_zh_CN.md - 同上

**CHANGELOG.md：**
- 在 v2.1.0 版本中添加说明：移除闪卡快速切换功能

### 5️⃣ 更新版本号

建议保持 v2.1.0，在 CHANGELOG 中说明移除了闪卡功能。

---

## 🔍 依赖关系总结

```
主入口 src/index.ts
  └─ 未使用闪卡功能 ✅

工具栏劫持器 src/utils/toolbarHijacker.ts
  ├─ 导入 FlashcardQuickSwitchManager ❌ 需删除
  ├─ 创建和管理闪卡实例 ❌ 需删除
  └─ 销毁闪卡实例 ❌ 需删除

日志工具 src/utils/logger.ts
  └─ 闪卡图标定义 ⚠️ 可选删除

闪卡模块 src/flashcard/
  └─ 整个目录 ❌ 直接删除
```

---

## ⚠️ 注意事项

1. **不影响其他功能**：闪卡功能与高亮、备注、标签功能完全独立
2. **文件引用检查**：删除后建议运行 `pnpm run build` 确保没有编译错误
3. **测试验证**：删除后需要测试其他功能是否正常
4. **用户通知**：如果有用户在使用闪卡功能，需要在更新日志中明确说明

---

## 🚀 执行建议

我可以帮你执行以下操作：
1. ✅ 删除 src/flashcard/ 目录
2. ✅ 修改 src/utils/toolbarHijacker.ts（删除闪卡相关代码）
3. ✅ 修改 src/utils/logger.ts（删除闪卡图标）
4. ✅ 更新所有 README 文件（删除闪卡功能描述）
5. ✅ 更新 CHANGELOG.md（说明移除闪卡功能）

**是否需要我执行这些操作？**

