# 电脑版支持说明

## 概述

高亮助手插件现已支持思源笔记的电脑版，可以在只读模式下使用高亮和备注功能。

## 功能特性

### ✅ 支持的功能
- 🎨 **多色高亮**: 4种颜色选择（黄色、蓝色、绿色、粉色）
- 💭 **智能备注**: 为高亮文本添加个人想法
- 🔄 **状态管理**: 修改和删除现有高亮和备注
- 🌙 **主题适配**: 完美适配明暗主题切换
- 💻 **电脑版优化**: 专为电脑版界面优化的按钮和工具栏

### 📱 平台差异

| 功能 | 手机版 | 电脑版 |
|------|--------|--------|
| 高亮颜色 | ✅ 4种颜色 | ✅ 4种颜色 |
| 备注功能 | ✅ 支持 | ✅ 支持 |
| 工具栏样式 | 圆形按钮 | 方形按钮 |
| 按钮大小 | 22px | 28px |
| 触摸支持 | ✅ 完整支持 | ✅ 鼠标悬停效果 |
| 只读模式 | ✅ 支持 | ✅ 支持 |

## 使用方法

### 1. 启用插件
1. 在思源笔记中打开设置
2. 进入 `集市` → `已下载` → `插件`
3. 找到"高亮助手"插件并启用
4. 重启思源笔记

### 2. 使用高亮功能
1. **选择文本**: 在只读模式下选择任意文本
2. **选择颜色**: 点击工具栏中的颜色按钮进行高亮
3. **添加备注**: 点击备注按钮为高亮文本添加个人想法
4. **管理高亮**: 点击已高亮的文本可以修改颜色或删除

### 3. 电脑版特殊操作
- **鼠标悬停**: 按钮会有悬停效果
- **键盘快捷键**: 支持ESC键取消操作
- **精确选择**: 电脑版提供更精确的文本选择体验

## 技术实现

### 环境检测
插件会自动检测当前运行环境：
- 通过 `getFrontend()` API 检测平台类型
- 通过屏幕宽度和用户代理判断设备类型
- 根据平台类型调整UI和交互方式

### 工具栏劫持
- 劫持思源原生的工具栏显示方法
- 在原有工具栏基础上添加高亮功能按钮
- 保持与思源原生功能的兼容性

### 样式适配
- 使用CSS媒体查询区分手机版和电脑版
- 电脑版使用方形按钮，手机版使用圆形按钮
- 响应式设计确保在不同屏幕尺寸下都有良好体验

## 测试验证

### 自动测试
在思源笔记控制台中运行以下代码进行测试：

```javascript
// 运行测试脚本
testHighlightAssistant.runAllTests();
```

### 手动测试步骤
1. 打开思源笔记电脑版
2. 进入只读模式
3. 选择一段文本
4. 检查是否出现高亮工具栏
5. 尝试使用不同颜色进行高亮
6. 测试备注功能
7. 验证高亮文本的修改和删除功能

## 故障排除

### 常见问题

**Q: 电脑版没有显示高亮工具栏？**
A: 请检查：
- 插件是否已启用
- 是否在只读模式下
- 控制台是否有错误信息

**Q: 高亮按钮样式异常？**
A: 请检查：
- 浏览器是否支持CSS媒体查询
- 是否有其他插件样式冲突

**Q: 备注功能不工作？**
A: 请检查：
- 是否选择了有效文本
- 网络连接是否正常
- 思源API是否可用

### 调试方法
1. 打开浏览器开发者工具
2. 查看控制台输出
3. 运行 `testHijack()` 函数检查劫持状态
4. 检查网络请求是否正常

## 更新日志

### v1.1.0 (2024-01-XX)
- ✅ 新增电脑版支持
- ✅ 优化平台检测逻辑
- ✅ 改进UI适配
- ✅ 增强错误处理
- ✅ 添加测试工具

## 技术支持

如果遇到问题，请：
1. 查看控制台错误信息
2. 运行测试脚本诊断问题
3. 提交Issue并附上详细描述
4. 提供系统环境信息

---

**注意**: 电脑版支持目前仅在只读模式下可用，编辑模式下的支持将在后续版本中提供。
